@(title: String)(content: Html)(implicit request: play.api.mvc.RequestHeader)

@defining(request.cookies.get("theme").map(_.value).getOrElse("auto")) { theme =>
    @defining(request.path == controllers.routes.HomeController.home().url) { isHome =>
        @defining(request.path == controllers.routes.HomeController.ingame().url) { isIngame =>
            @defining((if(isHome) "page-home" else "") + (if(isIngame) " page-ingame" else "")) { pageClass =>
                @defining(theme match { case "light" => "theme-light"; case "dark" => "theme-dark"; case _ => "theme-auto" }) { themeClass =>
                    @defining(theme match { case "dark" => "Light Mode"; case _ => "Dark Mode" }) { toggleLabel =>

                    <!DOCTYPE html>
                        <html lang="de" data-bs-theme="@theme">
                            <head>
                                <meta charset="utf-8">
                                <meta name="viewport" content="width=device-width, initial-scale=1">
                                <title>@title</title>
                                    <!-- Bootstrap -->
                                <link href="https://cdn.jsdelivr.net/npm/bootstrap@@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
                                    <!-- Play -->
                                <link rel="stylesheet" media="screen" href='@controllers.routes.Assets.versioned("stylesheets/main.css")'>
                                    <!-- Schriftart -->
                                <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@@400;700;900&display=swap" rel="stylesheet">
                            </head>
                            <body class="game @themeClass @pageClass">
                                <header class="game__header">
                                @defining(request.path == controllers.routes.HomeController.ingame().url) { isIngame =>
                                    @defining(if (isIngame) "navbar navbar-expand-lg" else "navbar navbar-expand-lg bg-body-tertiary fixed-top") { navClasses =>
                                        @defining(if(isIngame) "container-xxl" else "container-fluid") { containerClass =>
                                            <nav class="@navClasses" aria-label="Hauptnavigation">
                                                <div class="@containerClass">
                                                    <!-- Brand / Icon führt zu /home -->
                                                    <a class="navbar-brand d-flex align-items-center" href='@controllers.routes.HomeController.home()' aria-label="Wizard Home">
                                                        <span class="brand-w" aria-hidden="true">W</span>
                                                        <span class="visually-hidden">Wizard</span>
                                                    </a>

                                                        <!-- Mobile Toggler -->
                                                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Menü umschalten">
                                                        <span class="navbar-toggler-icon"></span>
                                                    </button>

                                                        <!-- Kollabierbarer Bereich -->
                                                    <div class="collapse navbar-collapse" id="mainNav">
                                                            <!-- Linkliste links; `me-auto` drückt den Rest nach rechts -->
                                                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(request.path == controllers.routes.HomeController.home().url) { active }" href='@controllers.routes.HomeController.home()'>
                                                                    Home</a>
                                                            </li>
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(request.path == controllers.routes.HomeController.rules().url) { active }" href='@controllers.routes.HomeController.rules()'>
                                                                    Rules</a>
                                                            </li>
                                                            @if(!isIngame) {
                                                                <li class="nav-item">
                                                                    <a class="nav-link @if(request.path == controllers.routes.HomeController.modify().url) { active }" href='@controllers.routes.HomeController.modify()'>
                                                                        Modify</a>
                                                                </li>
                                                            }
                                                        </ul>

                                                            <!-- Theme-Schalter ganz rechts -->
                                                        <div class="d-flex">
                                                            <a class="btn btn-outline-secondary" href='@controllers.routes.ThemeController.toggleTheme(returnTo = request.uri)'>
                                                            @toggleLabel
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </nav>
                                        }
                                    }
                                }
                                </header>
                                @content

                                    <!-- Bootstrap JavaScript bundle (includes Popper) -->
                                <script src="https://cdn.jsdelivr.net/npm/bootstrap@@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
                            </body>
                        </html>

                    }
                }
            }
        }
    }
}