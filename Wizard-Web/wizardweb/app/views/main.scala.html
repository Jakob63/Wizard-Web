@(title: String)(content: Html)(implicit request: play.api.mvc.RequestHeader)

@defining(request.cookies.get("theme").map(_.value).getOrElse("auto")) { theme =>
    @defining(request.path) { path =>
        @defining(path == controllers.routes.HomeController.home().url) { isHome =>
            @defining(path == controllers.routes.HomeController.ingame().url) { isIngame =>
                @defining(
                    if (isHome) "page-home" else if (isIngame) "page-ingame" else ""
                ) { pageClass =>
                    @defining(theme match { case "light" => "theme-light"; case "dark" => "theme-dark"; case _ => "theme-auto" }) { themeClass =>
                        @defining(theme match { case "dark" => "Light Mode"; case _ => "Dark Mode" }) { toggleLabel =>

                        <!DOCTYPE html>
                            <html lang="de" data-bs-theme="@theme">
                                <head>
                                    <meta charset="utf-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1">
                                    <title>@title</title>
                                    <link href="https://cdn.jsdelivr.net/npm/bootstrap@@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
                                    <link rel="stylesheet" media="screen" href='@controllers.routes.Assets.versioned("stylesheets/main.css")'>
                                    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@@400;700;900&display=swap" rel="stylesheet">
                                </head>
                                <body class="game @themeClass @pageClass">

                                        <!-- Neue Navbar -->
                                    @defining(if(isIngame) "navbar navbar-expand-lg navbar-dark bg-dark" else "navbar navbar-expand-lg navbar-dark bg-dark fixed-top px-0") { navbarCls =>
                                        <nav class="@navbarCls">
                                            @if(isIngame) {
                                                <div class="container-ingame">
                                                    <a class="navbar-brand d-flex align-items-center" href='@controllers.routes.HomeController.home()'>
                                                        <span class="brand-w">W</span>
                                                    </a>

                                                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Navigation umschalten">
                                                        <span class="navbar-toggler-icon"></span>
                                                    </button>

                                                    <div class="collapse navbar-collapse" id="mainNav">
                                                        <ul class="navbar-nav mb-2 mb-lg-0">
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(path == controllers.routes.HomeController.rules().url){active}" href='@controllers.routes.HomeController.rules()'>Rules</a>
                                                            </li>
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(path == controllers.routes.HomeController.ingame().url){active}" href='@controllers.routes.HomeController.ingame()'>Game</a>
                                                            </li>
                                                            <!-- Modify in Navbar nicht in /ingame anzeigen -->
                                                        </ul>
                                                    </div>

                                                    <div class="ms-auto d-flex align-items-center">
                                                        <a class="btn btn-outline-light btn-sm" href='@controllers.routes.ThemeController.toggleTheme(returnTo = request.uri)'>@toggleLabel</a>
                                                    </div>
                                                </div>
                                            } else {
                                                <div class="container-fluid ps-2">
                                                    <a class="navbar-brand d-flex align-items-center" href='@controllers.routes.HomeController.home()'>
                                                        <span class="brand-w">W</span>
                                                    </a>

                                                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Navigation umschalten">
                                                        <span class="navbar-toggler-icon"></span>
                                                    </button>

                                                    <div class="collapse navbar-collapse" id="mainNav">
                                                        <ul class="navbar-nav mb-2 mb-lg-0">
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(path == controllers.routes.HomeController.rules().url){active}" href='@controllers.routes.HomeController.rules()'>Rules</a>
                                                            </li>
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(path == controllers.routes.HomeController.ingame().url){active}" href='@controllers.routes.HomeController.ingame()'>Game</a>
                                                            </li>
                                                            <li class="nav-item">
                                                                <a class="nav-link @if(path == controllers.routes.HomeController.modify().url){active}" href='@controllers.routes.HomeController.modify()'>Modify</a>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                    <div class="ms-auto d-flex align-items-center">
                                                        <a class="btn btn-outline-light btn-sm" href='@controllers.routes.ThemeController.toggleTheme(returnTo = request.uri)'>@toggleLabel</a>
                                                    </div>
                                                </div>
                                            }
                                        </nav>
                                    }

                                    @content

                                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
                                </body>
                            </html>

                        }
                    }
                }
            }
        }
    }
}